<!DOCTYPE html>
<html lang="ko">
<head>
<%-include('../_templates/_data.head.front.ejs', {
	pageStyle: 'page.etc.css',
	pageJavascript: ''
}) %>
<style>
	.page-foot {
		display: block;
		position: absolute;
		overflow: hidden;
		margin: -1px;
		padding: 0;
		width: 1px;
		height: 1px;
		line-height: 1px;
		font-size: 1px;
		border: 0;
		clip: rect(0 0 0 0);
	}

	body.has-content-panel #page {
		margin-bottom: 0;
	}
</style>
</head>
<body>
	<div id="page">
		<%-include('../_templates/_header.front.ejs') %>
		<!--page-body-->
		<div class="page-body" id="local">
			<!--local-head-->
			<div class="local-head">
				<h2 class="local-title"><span class="local-name">더보기</span></h2>
				<!--local-control-->
				<div class="local-control">
					<span class="control-item"><a class="control-name" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" focusable="false"><title>이전으로</title><path d="M10.8,5.2c0.2,0.2,0.3,0.6,0.1,0.9l-0.1,0.1l-5.3,5.2l14.8,0c0.3,0,0.6,0.3,0.6,0.6c0,0.3-0.2,0.5-0.5,0.6l-0.1,0l-14.8,0l5.3,5.2c0.2,0.2,0.3,0.6,0.1,0.9l-0.1,0.1c-0.2,0.2-0.6,0.3-0.9,0.1l-0.1-0.1L3,12l6.8-6.8C10.1,4.9,10.5,4.9,10.8,5.2z"></path></svg></a></span>
					<span class="control-item"><a class="control-name" data-toggle-button="#pageBaseline" href="#pageBaseline"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" focusable="false"><title>메인으로</title><path d="M21.8,10.2L21.8,10.2l-8.1-6.6c-0.9-0.8-2.3-0.8-3.3,0l-8.1,6.6C2,10.4,1.9,10.8,2.1,11c0.2,0.3,0.6,0.3,0.8,0.1l1-0.8v7.1 c0,2,1.6,3.6,3.6,3.6h8.8c2,0,3.6-1.6,3.6-3.6v-7.1l1,0.8c0.1,0.1,0.2,0.1,0.4,0.1c0.2,0,0.3-0.1,0.5-0.2 C22.1,10.8,22,10.4,21.8,10.2z M18.8,17.4L18.8,17.4c0,1.3-1.1,2.4-2.4,2.4H7.6c-1.3,0-2.4-1.1-2.4-2.4V9.3l5.9-4.8 c0.5-0.4,1.3-0.4,1.8,0l5.9,4.8V17.4z M15,16c1.1,0,2-0.9,2-2c0-1.1-0.9-2-2-2s-2,0.9-2,2C13,15.1,13.9,16,15,16z M15,13.2 c0.4,0,0.8,0.4,0.8,0.8c0,0.4-0.4,0.8-0.8,0.8c-0.4,0-0.8-0.4-0.8-0.8C14.2,13.5,14.6,13.2,15,13.2z"></path></svg></a></span>
				</div>
				<!--//local-control-->
			</div>
			<!--//local-head-->
			<!--local-body-->
			<div class="local-body event-roulette" id="content">
				<!--content-head-->
				<div class="content-head">
					<h3 class="content-title"><span class="content-name">룰렛출첵</span></h3>
				</div>
				<!--//content-head-->
				<!--content-body-->
				<div class="content-body">
					<!--roulette-->
					<div class="section default roulette">
						<div class="section-head">
							<div class="section-title"><h4 class="section-name"><img class="image" src="./../../assets/images/etc/img_roulette_title.png" alt="슬기로운 출첵생활" /></h4></div>
							<div class="section-intro">
								<p class="summary">클릭만 해도 100% 당첨되는 행운의 룰렛<br>한달 ALL 출석 시 <strong>3,000포인트</strong>를 드립니다!</p>
							</div>
						</div>
						<div class="section-body">
							<div class="roulette-content">
								<div class="roulette-board"><div class="roulette-target"><img class="image" src="./../../assets/images/etc/img_roulette_circle.png" alt="쇼핑지원금100P, 할인쿠폰2%, 쇼핑지원금500P, 할인쿠폰5%, 쇼핑지원금1,000P, 할인쿠폰10%, 쇼핑지원금10,000P, 할인쿠폰50%" /></div></div>
								<button type="button" class="roulette-button"><img class="image" src="./../../assets/images/etc/img_roulette_go.png" alt="go" /></button>
							</div>
							<p class="para">룰렛 이벤트는 ID당 1일 1회만 이용이 가능합니다.<br />출석체크는 룰렛 이용 시 자동으로 체크 됩니다.</p>
							<div class="subsection">
								<div class="subsection-head"><div class="subsection-title"><h5 class="subsection-name">이벤트 참여 현황</h5></div></div>
								<div class="subsection-body">
									<ul class="data-list">
										<li class="data-item">
											<div class="data-area">
												<span class="head">나의 출석일수</span>
												<span class="body">3회</span>
											</div>
										</li>
										<li class="data-item">
											<div class="data-area">
												<span class="head">나의 보유포인트</span>
												<span class="body">2,700P</span>
											</div>
										</li>
									</ul>
								</div>
							</div>
						</div>
					</div>
					<!--//roulette-->
					<!--calendar-area-->
					<div class="calendar-area">
						<div class="calendar-month"><span class="value">2</span><span class="unit">월</span></div>
						<table>
							<caption>룰렛 출석 체크 달력</caption>
							<colgroup>
								<col>
								<col>
								<col>
								<col>
								<col>
								<col>
								<col>
							</colgroup>
							<thead>
								<tr>
									<th scope="col">일</th>
									<th scope="col">월</th>
									<th scope="col">화</th>
									<th scope="col">수</th>
									<th scope="col">목</th>
									<th scope="col">금</th>
									<th scope="col">토</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td></td>
									<td class="checked"><span class="day-number" title="출석 체크">1</span></td>
									<td><span class="day-number">2</span></td>
									<td><span class="day-number">3</span></td>
									<td><span class="day-number">4</span></td>
									<td><span class="day-number">5</span></td>
									<td><span class="day-number">6</span></td>
								</tr>
								<tr>
									<td><span class="day-number">7</span></td>
									<td><span class="day-number">8</span></td>
									<td><span class="day-number">9</span></td>
									<td><span class="day-number">10</span></td>
									<td><span class="day-number">11</span></td>
									<td><span class="day-number">12</span></td>
									<td><span class="day-number">13</span></td>
								</tr>
								<tr>
									<td><span class="day-number">14</span></td>
									<td><span class="day-number">15</span></td>
									<td><span class="day-number">16</span></td>
									<td><span class="day-number">17</span></td>
									<td><span class="day-number">18</span></td>
									<td><span class="day-number">19</span></td>
									<td><span class="day-number">20</span></td>
								</tr>
								<tr>
									<td><span class="day-number">21</span></td>
									<td><span class="day-number">22</span></td>
									<td><span class="day-number">23</span></td>
									<td><span class="day-number">24</span></td>
									<td><span class="day-number">25</span></td>
									<td><span class="day-number">26</span></td>
									<td><span class="day-number">27</span></td>
								</tr>
								<tr>
									<td><span class="day-number">28</span></td>
									<td></td>
									<td></td>
									<td></td>
									<td></td>
									<td></td>
									<td></td>
								</tr>
							</tbody>
						</table>
					</div>
					<!--//calendar-area-->
				</div>
				<!--//content-body-->
			</div>
			<!--//local-body-->
		</div>
		<!--//page-body-->
		<%-include('../_templates/_footer.blank.ejs') %>

		<!--layer-popup-->
		<div class="layer-popup style-b type-a roulette-layer" id="roulettePrize" data-bui-toggle="open-popup" data-bui-toggle-target="roulettePrize" tabindex="0">
			<div class="popup-item">
				<div class="popup-area">
					<div class="popup-head"><h2 class="popup-title"><span class="popup-name">룰렛 이벤트 당첨 팝업</span></h2></div>
					<div class="popup-body">
						<!--coupon-->
						<div class="coupon style-a type-a">
							<span class="coupon-title">
								<span class="type">Coupon</span>
								<span class="coupon-name">룰렛출첵<br>이벤트</span>
							</span>
						</div>
						<!--//coupon-->
						<div class="lottie" id="getCoupont"></div>
						<script>
							var getCoupont = bodymovin.loadAnimation({
								container: document.getElementById('getCoupont'),
								path: './../../assets/lottie/get_coupon.json',
								renderer: 'svg',
								loop: true,
								autoplay: true
							});
						</script>
						<div class="info-board style-a type-b">
							<p class="board-head">축하합니다!</p>
							<p class="board-body" id="prizeText"></p>
						</div>
						
					</div>
				</div>
				<div class="popup-control">
					<div class="button-area">
						<button class="btn" data-bui-toggle-inactive type="button"><span class="btn-text">확인</span></button>
					</div>
				</div>
			</div>
		</div>
		<!--//layer-popup-->
	</div>
	<script>
		let probability = [34.5,34.5,10,10,5,5,0.5,0.5], // 확률을 정해주세요, 쇼핑지원금100P, 할인쿠폰2%, 쇼핑지원금500P, 할인쿠폰5%, 쇼핑지원금1,000P, 할인쿠폰10%, 쇼핑지원금10,000P, 할인쿠폰50%
			turns = [0, 50, 50], // 바퀴수, 1, 2, 3
			rouletteStu = 0,
			prizeText = [
				'<span class="wbr">쇼핑지원금 <strong class="em style-a accent-01">100P</strong>가</span> <span class="wbr">지급 되었습니다.</span>',
				'<span class="wbr">할인쿠폰 <strong class="em style-a accent-01">2%</strong>가</span> <span class="wbr">지급 되었습니다.</span>',
				'<span class="wbr">쇼핑지원금 <strong class="em style-a accent-01">500P</strong>가</span> <span class="wbr">지급 되었습니다.</span>',
				'<span class="wbr">할인쿠폰 <strong class="em style-a accent-01">5%</strong>가</span> <span class="wbr">지급 되었습니다.</span>',
				'<span class="wbr">쇼핑지원금 <strong class="em style-a accent-01">1,000P</strong>가</span> <span class="wbr">지급 되었습니다.</span>',
				'<span class="wbr">할인쿠폰 <strong class="em style-a accent-01">10%</strong>가</span> <span class="wbr">지급 되었습니다.</span>',
				'<span class="wbr">쇼핑지원금 <strong class="em style-a accent-01">10,000P</strong>가</span> <span class="wbr">지급 되었습니다.</span>',
				'<span class="wbr">할인쿠폰 <strong class="em style-a accent-01">50%</strong>가</span> <span class="wbr">지급 되었습니다.</span>'
			],
			prize,
			turn,
			rot,
			rouletteBtn = document.querySelector(".roulette-button"),
			rouletteTarget = document.querySelector(".roulette-target img"),
			roulettelayer = document.querySelector("#roulettePrize")
			prizeTextTarget = document.querySelector("#prizeText");

		let chanceCalculate = function(chances) {
			var sum = 0;

			chances.forEach(function(chance) {
				sum+=chance;
			});

			var rand = Math.random();
			var chance = 0;

			for(var i=0; i<chances.length; i++) {
				chance+=chances[i]/sum;
				if(rand<chance) {
					return i
				}
			}
			return -1;
		};

		let rouletteEvent = function() {
			prize = chanceCalculate(probability);
			turn = chanceCalculate(turns);
			rot = (prize * -45) + (turn * -360);
				
			if (rouletteStu == 0) {
				rouletteTarget.style.transform="rotate("+rot+"deg)";
				prizeTextTarget.innerHTML = prizeText[prize];
				rouletteStu++

				setTimeout(function(){
					roulettelayer.classList.add('active');
					rouletteBtn.innerHTML='<img src="./../../assets/images/etc/img_roulette_completed.png" alt="참여완료" />';
				}, 2000)

			} else {
				alert("이미 참여하셨습니다.");
			}
		};
		rouletteBtn.addEventListener('click', rouletteEvent);

	</script>
</body>
</html>


